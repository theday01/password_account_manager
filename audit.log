2025-11-24 22:05:52,340 - root - INFO - Logging has been set up.
2025-11-24 22:05:52,341 - __main__ - INFO - Starting SecureVault Pro...
2025-11-24 22:05:53,048 - asyncio_manager - INFO - Asyncio event loop started in background thread.
2025-11-24 22:05:53,815 - __main__ - INFO - Application initialized successfully
2025-11-24 22:05:57,698 - __main__ - INFO - Initializing secure file management system...
2025-11-24 22:05:57,699 - __main__ - INFO - Secure file manager initialized
2025-11-24 22:05:58,218 - secure_file_manager - INFO - Settings file does not exist: secure_vault\settings.json
2025-11-24 22:05:58,656 - root - INFO - --- Starting Trial Status Check ---
2025-11-24 22:05:58,711 - root - INFO - Guardian Anchor check returned: status=OK_RESTORED_FROM_BACKUP, data={'install_ts': '2025-11-24T19:12:17.175120', 'machine_fp': '57760c5575fad941f37d490b1cd91368b4d441c49745fb8b3e0734efe5118ed6', 'shutdown_status': 'RUNNING'}
2025-11-24 22:05:58,711 - root - INFO - Installation timestamp: 2025-11-24 19:12:17.175120
2025-11-24 22:05:58,712 - root - INFO - Current UTC time: 2025-11-24 21:05:58.711922
2025-11-24 22:05:58,712 - root - INFO - Time elapsed since installation: 1:53:41.536802
2025-11-24 22:05:58,712 - root - INFO - Trial period: 8 days, 0:00:00
2025-11-24 22:05:58,722 - root - INFO - Guardian Observer check returned: OK_UNEXPECTED_SHUTDOWN
2025-11-24 22:05:58,723 - root - INFO - Trial is active. Minutes remaining: 11406.31. Status: TRIAL
2025-11-24 22:05:58,724 - __main__ - INFO - Trial status at startup: TRIAL
2025-11-24 22:05:59,182 - auth_guardian - INFO - AuthGuardian init: No encryption key available, starting with empty settings. Will reload after authentication.
2025-11-24 22:05:59,183 - __main__ - INFO - Loading settings from auth_guardian: []
2025-11-24 22:05:59,183 - __main__ - INFO - Loaded tutorial_completed: False
2025-11-24 22:05:59,187 - __main__ - INFO - Vault not initialized, showing setup wizard
2025-11-24 22:06:19,539 - secure_file_manager - INFO - Initializing encryption...
2025-11-24 22:06:19,540 - secure_file_manager - INFO - Salt file not found, creating a new one.
2025-11-24 22:06:19,559 - secure_file_manager - INFO - Salt loaded from secure_vault\salt_file
2025-11-24 22:06:19,560 - secure_file_manager - INFO - Using 'cryptography' package for key derivation.
2025-11-24 22:06:19,685 - secure_file_manager - INFO - Encryption key derived successfully.
2025-11-24 22:06:19,686 - secure_file_manager - INFO - Initializing vault files...
2025-11-24 22:06:19,686 - secure_file_manager - INFO - Metadata database not found, creating at secure_vault\metadata.db
2025-11-24 22:06:19,713 - secure_file_manager - INFO - Sensitive database not found, creating at secure_vault\sensitive.db
2025-11-24 22:06:19,726 - secure_file_manager - INFO - Rotating integrity signature.
2025-11-24 22:06:19,730 - secure_file_manager - INFO - Using HMAC-SHA256 for integrity signature.
2025-11-24 22:06:19,733 - secure_file_manager - INFO - Integrity signature written to secure_vault\integrity_file
2025-11-24 22:06:19,733 - secure_file_manager - INFO - Enforcing permissions...
2025-11-24 22:06:19,733 - secure_file_manager - INFO - Applying Windows permissions (best-effort).
2025-11-24 22:06:19,734 - secure_file_manager - INFO - Permissions enforced successfully.
2025-11-24 22:06:19,734 - secure_file_manager - INFO - Vault files initialized successfully.
2025-11-24 22:06:19,735 - __main__ - INFO - Starting database initialization...
2025-11-24 22:06:19,855 - __main__ - INFO - Generated salt (32 bytes) and encryption keys
2025-11-24 22:06:19,856 - __main__ - INFO - Salt saved to secure_vault\salt_file
2025-11-24 22:06:19,862 - __main__ - INFO - Metadata database created
2025-11-24 22:06:19,865 - __main__ - INFO - Sensitive database created
2025-11-24 22:06:19,866 - __main__ - INFO - Creating master account for authentication...
2025-11-24 22:06:19,885 - __main__ - INFO - Master account created successfully
2025-11-24 22:06:19,885 - secure_file_manager - INFO - Rotating integrity signature.
2025-11-24 22:06:19,888 - secure_file_manager - INFO - Using HMAC-SHA256 for integrity signature.
2025-11-24 22:06:19,890 - secure_file_manager - INFO - Integrity signature written to secure_vault\integrity_file
2025-11-24 22:06:19,891 - __main__ - INFO - Integrity signature created
2025-11-24 22:06:19,891 - __main__ - INFO - Testing authentication with new password...
2025-11-24 22:06:19,891 - __main__ - INFO - Attempting authentication...
2025-11-24 22:06:19,891 - __main__ - INFO - Salt path: secure_vault\salt_file
2025-11-24 22:06:19,892 - __main__ - INFO - Metadata DB path: secure_vault\metadata.db
2025-11-24 22:06:19,892 - __main__ - INFO - Sensitive DB path: secure_vault\sensitive.db
2025-11-24 22:06:19,892 - __main__ - INFO - Integrity path: secure_vault\integrity_file
2025-11-24 22:06:19,902 - __main__ - INFO - Salt loaded successfully (32 bytes)
2025-11-24 22:06:20,019 - __main__ - INFO - Encryption keys generated
2025-11-24 22:06:20,020 - secure_file_manager - INFO - Verifying integrity...
2025-11-24 22:06:20,030 - secure_file_manager - INFO - Verifying with HMAC-SHA256.
2025-11-24 22:06:20,030 - secure_file_manager - INFO - Integrity verification result: OK
2025-11-24 22:06:20,031 - __main__ - INFO - Database integrity check: PASSED
2025-11-24 22:06:20,034 - __main__ - INFO - Test decryption and password verification successful
2025-11-24 22:06:20,035 - __main__ - INFO - Authentication successful!
2025-11-24 22:06:20,035 - __main__ - INFO - Authentication test successful
2025-11-24 22:06:20,036 - __main__ - INFO - DB Action: CREATE, Type: SYSTEM, ID: database, Details: Database initialized successfully
2025-11-24 22:06:20,043 - __main__ - INFO - Database initialization completed successfully!
2025-11-24 22:06:20,224 - __main__ - INFO - Security questions saved successfully.
2025-11-24 22:06:20,227 - secure_file_manager - INFO - Syncing all files...
2025-11-24 22:06:20,227 - secure_file_manager - INFO - Syncing from current working directory: C:\Users\Hamza\Desktop\scripts\3 - Control Ur PassWord & Gen
2025-11-24 22:06:20,228 - secure_file_manager - INFO - Rotating integrity signature.
2025-11-24 22:06:20,230 - secure_file_manager - INFO - Using HMAC-SHA256 for integrity signature.
2025-11-24 22:06:20,231 - secure_file_manager - INFO - Integrity signature written to secure_vault\integrity_file
2025-11-24 22:06:20,232 - secure_file_manager - INFO - Sync from current working directory completed.
2025-11-24 22:07:15,140 - __main__ - INFO - Initializing encryption...
2025-11-24 22:07:15,141 - secure_file_manager - INFO - Initializing encryption...
2025-11-24 22:07:15,141 - secure_file_manager - INFO - Salt loaded from secure_vault\salt_file
2025-11-24 22:07:15,142 - secure_file_manager - INFO - Using 'cryptography' package for key derivation.
2025-11-24 22:07:15,266 - secure_file_manager - INFO - Encryption key derived successfully.
2025-11-24 22:07:15,267 - __main__ - INFO - Loading files from secure storage...
2025-11-24 22:07:15,267 - secure_file_manager - INFO - Loading files to temporary directory...
2025-11-24 22:07:15,270 - secure_file_manager - INFO - Created new temp directory: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ygxpywto
2025-11-24 22:07:15,274 - secure_file_manager - INFO - Updated paths to point to temp directory. settings_path now: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ygxpywto\settings.json
2025-11-24 22:07:15,275 - secure_file_manager - INFO - Files loaded to temp directory successfully.
2025-11-24 22:07:15,275 - __main__ - INFO - Attempting authentication...
2025-11-24 22:07:15,276 - __main__ - INFO - Salt path: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ygxpywto\salt_file
2025-11-24 22:07:15,277 - __main__ - INFO - Metadata DB path: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ygxpywto\metadata.db
2025-11-24 22:07:15,277 - __main__ - INFO - Sensitive DB path: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ygxpywto\sensitive.db
2025-11-24 22:07:15,278 - __main__ - INFO - Integrity path: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ygxpywto\integrity_file
2025-11-24 22:07:15,280 - __main__ - INFO - Salt loaded successfully (32 bytes)
2025-11-24 22:07:15,399 - __main__ - INFO - Encryption keys generated
2025-11-24 22:07:15,400 - secure_file_manager - INFO - Verifying integrity...
2025-11-24 22:07:15,404 - secure_file_manager - INFO - Verifying with HMAC-SHA256.
2025-11-24 22:07:15,404 - secure_file_manager - INFO - Integrity verification result: FAILED
2025-11-24 22:07:15,404 - __main__ - INFO - Database integrity check: FAILED
2025-11-24 22:07:15,404 - __main__ - ERROR - Database integrity check failed
2025-11-24 22:07:15,405 - __main__ - INFO - Attempting integrity recovery...
2025-11-24 22:07:15,405 - secure_file_manager - INFO - Rotating integrity signature.
2025-11-24 22:07:15,406 - secure_file_manager - INFO - Using HMAC-SHA256 for integrity signature.
2025-11-24 22:07:15,408 - secure_file_manager - INFO - Integrity signature written to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ygxpywto\integrity_file
2025-11-24 22:07:15,408 - __main__ - INFO - Integrity signature regenerated, retrying verification...
2025-11-24 22:07:15,409 - secure_file_manager - INFO - Verifying integrity...
2025-11-24 22:07:15,420 - secure_file_manager - INFO - Verifying with HMAC-SHA256.
2025-11-24 22:07:15,420 - secure_file_manager - INFO - Integrity verification result: OK
2025-11-24 22:07:15,420 - __main__ - INFO - Integrity recovery successful
2025-11-24 22:07:15,423 - __main__ - INFO - Test decryption and password verification successful
2025-11-24 22:07:15,423 - __main__ - INFO - Authentication successful!
2025-11-24 22:07:15,425 - __main__ - INFO - Adding missing column 'recovery_email' to 'accounts' table.
2025-11-24 22:07:15,430 - __main__ - INFO - Adding missing column 'phone_number' to 'accounts' table.
2025-11-24 22:07:15,431 - __main__ - INFO - Adding missing column 'account_type' to 'accounts' table.
2025-11-24 22:07:15,433 - __main__ - INFO - Adding missing column 'category' to 'accounts' table.
2025-11-24 22:07:15,434 - __main__ - INFO - Adding missing column 'two_factor_enabled' to 'accounts' table.
2025-11-24 22:07:15,435 - __main__ - INFO - Adding missing column 'last_password_change' to 'accounts' table.
2025-11-24 22:07:15,437 - __main__ - INFO - Schema migration check completed successfully.
2025-11-24 22:07:15,439 - __main__ - INFO - Encryption key set on secure_file_manager after login. Key is set: True
2025-11-24 22:07:15,439 - __main__ - INFO - Calling reload_settings() after successful auth...
2025-11-24 22:07:15,439 - secure_file_manager - INFO - Settings file does not exist: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ygxpywto\settings.json
2025-11-24 22:07:15,440 - auth_guardian - INFO - Reloading settings, read_settings returned: []
2025-11-24 22:07:15,440 - auth_guardian - INFO - tfa_secret present in reloaded settings: False
2025-11-24 22:07:15,440 - auth_guardian - INFO - tfa_enabled_at present in reloaded settings: False
2025-11-24 22:07:15,440 - auth_guardian - INFO - After reload, _settings has: []
2025-11-24 22:07:15,442 - auth_guardian - INFO - After reload, is_tfa_enabled(): False
2025-11-24 22:07:15,442 - __main__ - INFO - reload_settings() completed
2025-11-24 22:07:15,443 - __main__ - INFO - Recording login attempt after settings reload...
2025-11-24 22:07:15,443 - auth_guardian - INFO - Successful master password login recorded. Resetting guardian state.
2025-11-24 22:07:15,443 - secure_file_manager - INFO - Settings file does not exist: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ygxpywto\settings.json
2025-11-24 22:07:15,444 - auth_guardian - INFO - No existing settings file found, starting with empty dict
2025-11-24 22:07:15,444 - auth_guardian - INFO - About to save settings. Keys to save: ['guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time']
2025-11-24 22:07:15,444 - secure_file_manager - INFO - Writing encrypted settings to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ygxpywto\settings.json. Settings keys: ['guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time']
2025-11-24 22:07:15,447 - secure_file_manager - INFO - Rotating integrity signature.
2025-11-24 22:07:15,460 - secure_file_manager - INFO - Using HMAC-SHA256 for integrity signature.
2025-11-24 22:07:15,462 - secure_file_manager - INFO - Integrity signature written to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ygxpywto\integrity_file
2025-11-24 22:07:15,462 - secure_file_manager - INFO - Settings file written successfully. Size: 375 bytes
2025-11-24 22:07:15,463 - auth_guardian - INFO - Successfully saved settings. Keys: ['guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time']
2025-11-24 22:07:15,464 - secure_file_manager - INFO - Read 375 bytes from settings file
2025-11-24 22:07:15,464 - secure_file_manager - INFO - Decrypting encrypted settings file...
2025-11-24 22:07:15,464 - secure_file_manager - INFO - Successfully decrypted settings. Keys: ['guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time']
2025-11-24 22:07:15,465 - auth_guardian - INFO - Loaded existing settings before save. Keys: ['guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time']
2025-11-24 22:07:15,465 - auth_guardian - INFO - About to save settings. Keys to save: ['guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time']
2025-11-24 22:07:15,465 - secure_file_manager - INFO - Writing encrypted settings to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ygxpywto\settings.json. Settings keys: ['guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time']
2025-11-24 22:07:15,468 - secure_file_manager - INFO - Rotating integrity signature.
2025-11-24 22:07:15,479 - secure_file_manager - INFO - Using HMAC-SHA256 for integrity signature.
2025-11-24 22:07:15,480 - secure_file_manager - INFO - Integrity signature written to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ygxpywto\integrity_file
2025-11-24 22:07:15,481 - secure_file_manager - INFO - Settings file written successfully. Size: 375 bytes
2025-11-24 22:07:15,482 - auth_guardian - INFO - Successfully saved settings. Keys: ['guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time']
2025-11-24 22:07:15,482 - __main__ - INFO - Login attempt recorded
2025-11-24 22:07:15,482 - __main__ - INFO - Loading settings from auth_guardian: []
2025-11-24 22:07:15,483 - __main__ - INFO - Loaded tutorial_completed: False
2025-11-24 22:07:15,483 - __main__ - INFO - load_settings() completed
2025-11-24 22:07:15,483 - __main__ - INFO - Checking 2FA status: hasattr(auth_guardian)=True, auth_guardian exists=True
2025-11-24 22:07:15,483 - __main__ - INFO - 2FA is_tfa_enabled() returned: False
2025-11-24 22:07:15,484 - __main__ - INFO - 2FA is not enabled, skipping 2FA verification
2025-11-24 22:07:15,484 - auth_guardian - INFO - Updating setting 'last_login_timestamp' and persisting changes.
2025-11-24 22:07:15,484 - secure_file_manager - INFO - Read 375 bytes from settings file
2025-11-24 22:07:15,485 - secure_file_manager - INFO - Decrypting encrypted settings file...
2025-11-24 22:07:15,485 - secure_file_manager - INFO - Successfully decrypted settings. Keys: ['guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time']
2025-11-24 22:07:15,485 - auth_guardian - INFO - Loaded existing settings before save. Keys: ['guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time']
2025-11-24 22:07:15,486 - auth_guardian - INFO - About to save settings. Keys to save: ['guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time', 'last_login_timestamp']
2025-11-24 22:07:15,486 - secure_file_manager - INFO - Writing encrypted settings to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ygxpywto\settings.json. Settings keys: ['guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time', 'last_login_timestamp']
2025-11-24 22:07:15,488 - secure_file_manager - INFO - Rotating integrity signature.
2025-11-24 22:07:15,500 - secure_file_manager - INFO - Using HMAC-SHA256 for integrity signature.
2025-11-24 22:07:15,501 - secure_file_manager - INFO - Integrity signature written to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ygxpywto\integrity_file
2025-11-24 22:07:15,502 - secure_file_manager - INFO - Settings file written successfully. Size: 435 bytes
2025-11-24 22:07:15,503 - auth_guardian - INFO - Successfully saved settings. Keys: ['guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time', 'last_login_timestamp']
2025-11-24 22:07:15,503 - auth_guardian - INFO - Updating setting 'consecutive_logins' and persisting changes.
2025-11-24 22:07:15,504 - secure_file_manager - INFO - Read 435 bytes from settings file
2025-11-24 22:07:15,504 - secure_file_manager - INFO - Decrypting encrypted settings file...
2025-11-24 22:07:15,504 - secure_file_manager - INFO - Successfully decrypted settings. Keys: ['guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time', 'last_login_timestamp']
2025-11-24 22:07:15,505 - auth_guardian - INFO - Loaded existing settings before save. Keys: ['guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time', 'last_login_timestamp']
2025-11-24 22:07:15,505 - auth_guardian - INFO - About to save settings. Keys to save: ['guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time', 'last_login_timestamp', 'consecutive_logins']
2025-11-24 22:07:15,506 - secure_file_manager - INFO - Writing encrypted settings to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ygxpywto\settings.json. Settings keys: ['guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time', 'last_login_timestamp', 'consecutive_logins']
2025-11-24 22:07:15,508 - secure_file_manager - INFO - Rotating integrity signature.
2025-11-24 22:07:15,520 - secure_file_manager - INFO - Using HMAC-SHA256 for integrity signature.
2025-11-24 22:07:15,521 - secure_file_manager - INFO - Integrity signature written to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ygxpywto\integrity_file
2025-11-24 22:07:15,522 - secure_file_manager - INFO - Settings file written successfully. Size: 475 bytes
2025-11-24 22:07:15,522 - auth_guardian - INFO - Successfully saved settings. Keys: ['guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time', 'last_login_timestamp', 'consecutive_logins']
2025-11-24 22:07:15,523 - notification_manager - INFO - Trial mode active - backup notifications disabled
2025-11-24 22:07:16,570 - __main__ - INFO - Starting deferred startup tasks...
2025-11-24 22:07:16,571 - password_reminder - INFO - PasswordReminder initialized
2025-11-24 22:07:16,572 - password_reminder - INFO - Starting PasswordReminder timer (first check in 30 seconds)
2025-11-24 22:07:16,573 - password_reminder - INFO - Starting PasswordReminder timer (first check in 30 seconds)
2025-11-24 22:07:16,574 - __main__ - INFO - Password reminder initialized and started
2025-11-24 22:07:16,575 - __main__ - INFO - Expired passwords count updated
2025-11-24 22:07:16,576 - __main__ - INFO - Deferred startup tasks completed
2025-11-24 22:07:31,577 - password_reminder - INFO - Found 0 accounts older than 5 minutes
2025-11-24 22:07:31,591 - password_reminder - INFO - Found 0 accounts older than 5 minutes
2025-11-24 22:07:38,363 - secure_file_manager - INFO - Writing encrypted settings to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ygxpywto\settings.json. Settings keys: ['activation_failed_attempts', 'activation_lockout_end_time']
2025-11-24 22:07:38,388 - secure_file_manager - INFO - Rotating integrity signature.
2025-11-24 22:07:38,405 - secure_file_manager - INFO - Using HMAC-SHA256 for integrity signature.
2025-11-24 22:07:38,408 - secure_file_manager - INFO - Integrity signature written to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ygxpywto\integrity_file
2025-11-24 22:07:38,409 - secure_file_manager - INFO - Settings file written successfully. Size: 159 bytes
2025-11-24 22:07:39,280 - __main__ - INFO - Initiating secure program restart...
2025-11-24 22:07:39,308 - __main__ - INFO - Syncing files to secure storage...
2025-11-24 22:07:39,308 - secure_file_manager - INFO - Syncing all files...
2025-11-24 22:07:39,309 - secure_file_manager - INFO - Syncing from temp directory: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ygxpywto
2025-11-24 22:07:39,313 - secure_file_manager - INFO - Rotating integrity signature.
2025-11-24 22:07:39,314 - secure_file_manager - INFO - Using HMAC-SHA256 for integrity signature.
2025-11-24 22:07:39,316 - secure_file_manager - INFO - Integrity signature written to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ygxpywto\integrity_file
2025-11-24 22:07:39,316 - secure_file_manager - INFO - Sync from temp directory completed.
2025-11-24 22:07:39,316 - secure_file_manager - INFO - Verifying integrity...
2025-11-24 22:07:39,326 - secure_file_manager - INFO - Verifying with HMAC-SHA256.
2025-11-24 22:07:39,327 - secure_file_manager - INFO - Integrity verification result: OK
2025-11-24 22:07:39,327 - secure_file_manager - INFO - Cleaning up temporary files...
2025-11-24 22:07:39,328 - secure_file_manager - INFO - Removing temp directory: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ygxpywto
2025-11-24 22:07:39,329 - secure_file_manager - INFO - Restored paths to secure directory. settings_path now: secure_vault\settings.json
2025-11-24 22:07:39,330 - secure_file_manager - INFO - Temporary files cleaned up successfully.
2025-11-24 22:07:39,330 - __main__ - INFO - Temporary files cleaned up
2025-11-24 22:07:39,330 - __main__ - INFO - Secure shutdown completed
2025-11-24 22:07:39,331 - __main__ - INFO - Restarting program: c:/Users/Hamza/Desktop/scripts/3 - Control Ur PassWord & Gen/main.py
2025-11-24 22:07:39,390 - __main__ - INFO - Performing final sync and cleanup...
2025-11-24 22:07:39,418 - secure_file_manager - INFO - Cleaning up temporary files...
2025-11-24 22:07:39,418 - secure_file_manager - INFO - Restored paths to secure directory. settings_path now: secure_vault\settings.json
2025-11-24 22:07:39,421 - secure_file_manager - INFO - Temporary files cleaned up successfully.
2025-11-24 22:07:39,422 - __main__ - INFO - Secure cleanup completed
2025-11-24 22:07:40,083 - root - INFO - Logging has been set up.
2025-11-24 22:07:40,083 - __main__ - INFO - Starting SecureVault Pro...
2025-11-24 22:07:40,196 - asyncio_manager - INFO - Asyncio event loop started in background thread.
2025-11-24 22:07:40,941 - __main__ - INFO - Application initialized successfully
2025-11-24 22:07:44,849 - __main__ - INFO - Initializing secure file management system...
2025-11-24 22:07:44,851 - __main__ - INFO - Secure file manager initialized
2025-11-24 22:07:45,321 - secure_file_manager - INFO - Read 159 bytes from settings file
2025-11-24 22:07:45,321 - secure_file_manager - WARNING - Settings file is encrypted, but no encryption key is available (this is expected on startup).
2025-11-24 22:07:45,787 - root - INFO - --- Starting Trial Status Check ---
2025-11-24 22:07:45,787 - root - INFO - License file found at C:\Users\Hamza/sv-license-92123735fb6d0072.lic. Status: FULL
2025-11-24 22:07:45,787 - __main__ - INFO - Trial status at startup: FULL
2025-11-24 22:07:46,215 - auth_guardian - INFO - AuthGuardian init: No encryption key available, starting with empty settings. Will reload after authentication.
2025-11-24 22:07:46,215 - __main__ - INFO - Loading settings from auth_guardian: []
2025-11-24 22:07:46,215 - __main__ - INFO - Loaded tutorial_completed: False
2025-11-24 22:07:46,220 - secure_file_manager - INFO - Initializing encryption...
2025-11-24 22:07:46,221 - secure_file_manager - INFO - Salt loaded from secure_vault\salt_file
2025-11-24 22:07:46,222 - secure_file_manager - INFO - Using 'cryptography' package for key derivation.
2025-11-24 22:07:46,340 - secure_file_manager - INFO - Encryption key derived successfully.
2025-11-24 22:07:46,341 - secure_file_manager - INFO - Loading files to temporary directory...
2025-11-24 22:07:46,343 - secure_file_manager - INFO - Created new temp directory: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_v_v29wkz
2025-11-24 22:07:46,349 - secure_file_manager - INFO - Updated paths to point to temp directory. settings_path now: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_v_v29wkz\settings.json
2025-11-24 22:07:46,349 - secure_file_manager - INFO - Files loaded to temp directory successfully.
2025-11-24 22:07:46,349 - __main__ - INFO - Attempting authentication...
2025-11-24 22:07:46,350 - __main__ - INFO - Salt path: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_v_v29wkz\salt_file
2025-11-24 22:07:46,350 - __main__ - INFO - Metadata DB path: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_v_v29wkz\metadata.db
2025-11-24 22:07:46,350 - __main__ - INFO - Sensitive DB path: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_v_v29wkz\sensitive.db
2025-11-24 22:07:46,351 - __main__ - INFO - Integrity path: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_v_v29wkz\integrity_file
2025-11-24 22:07:46,353 - __main__ - INFO - Salt loaded successfully (32 bytes)
2025-11-24 22:07:46,469 - __main__ - INFO - Encryption keys generated
2025-11-24 22:07:46,470 - secure_file_manager - INFO - Verifying integrity...
2025-11-24 22:07:46,476 - secure_file_manager - INFO - Verifying with HMAC-SHA256.
2025-11-24 22:07:46,477 - secure_file_manager - INFO - Integrity verification result: FAILED
2025-11-24 22:07:46,477 - __main__ - INFO - Database integrity check: FAILED
2025-11-24 22:07:46,478 - __main__ - ERROR - Database integrity check failed
2025-11-24 22:07:46,478 - __main__ - INFO - Attempting integrity recovery...
2025-11-24 22:07:46,478 - secure_file_manager - INFO - Rotating integrity signature.
2025-11-24 22:07:46,480 - secure_file_manager - INFO - Using HMAC-SHA256 for integrity signature.
2025-11-24 22:07:46,482 - secure_file_manager - INFO - Integrity signature written to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_v_v29wkz\integrity_file
2025-11-24 22:07:46,482 - __main__ - INFO - Integrity signature regenerated, retrying verification...
2025-11-24 22:07:46,483 - secure_file_manager - INFO - Verifying integrity...
2025-11-24 22:07:46,493 - secure_file_manager - INFO - Verifying with HMAC-SHA256.
2025-11-24 22:07:46,493 - secure_file_manager - INFO - Integrity verification result: OK
2025-11-24 22:07:46,493 - __main__ - INFO - Integrity recovery successful
2025-11-24 22:07:46,497 - __main__ - ERROR - Test decryption failed: Invalid authentication tag. This almost certainly means the password is wrong.
2025-11-24 22:07:51,702 - __main__ - INFO - Initializing encryption...
2025-11-24 22:07:51,703 - secure_file_manager - INFO - Initializing encryption...
2025-11-24 22:07:51,704 - secure_file_manager - INFO - Salt loaded from C:\Users\Hamza\AppData\Local\Temp\sv_tmp_v_v29wkz\salt_file
2025-11-24 22:07:51,705 - secure_file_manager - INFO - Using 'cryptography' package for key derivation.
2025-11-24 22:07:51,838 - secure_file_manager - INFO - Encryption key derived successfully.
2025-11-24 22:07:51,839 - __main__ - INFO - Loading files from secure storage...
2025-11-24 22:07:51,839 - secure_file_manager - INFO - Loading files to temporary directory...
2025-11-24 22:07:51,840 - secure_file_manager - INFO - Removing old temp directory: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_v_v29wkz
2025-11-24 22:07:51,842 - secure_file_manager - INFO - Created new temp directory: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_b1sl9hc9
2025-11-24 22:07:51,847 - secure_file_manager - INFO - Updated paths to point to temp directory. settings_path now: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_b1sl9hc9\settings.json
2025-11-24 22:07:51,847 - secure_file_manager - INFO - Files loaded to temp directory successfully.
2025-11-24 22:07:51,848 - __main__ - INFO - Attempting authentication...
2025-11-24 22:07:51,848 - __main__ - INFO - Salt path: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_b1sl9hc9\salt_file
2025-11-24 22:07:51,848 - __main__ - INFO - Metadata DB path: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_b1sl9hc9\metadata.db
2025-11-24 22:07:51,849 - __main__ - INFO - Sensitive DB path: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_b1sl9hc9\sensitive.db
2025-11-24 22:07:51,849 - __main__ - INFO - Integrity path: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_b1sl9hc9\integrity_file
2025-11-24 22:07:51,851 - __main__ - INFO - Salt loaded successfully (32 bytes)
2025-11-24 22:07:51,971 - __main__ - INFO - Encryption keys generated
2025-11-24 22:07:51,971 - secure_file_manager - INFO - Verifying integrity...
2025-11-24 22:07:51,977 - secure_file_manager - INFO - Verifying with HMAC-SHA256.
2025-11-24 22:07:51,977 - secure_file_manager - INFO - Integrity verification result: FAILED
2025-11-24 22:07:51,977 - __main__ - INFO - Database integrity check: FAILED
2025-11-24 22:07:51,978 - __main__ - ERROR - Database integrity check failed
2025-11-24 22:07:51,978 - __main__ - INFO - Attempting integrity recovery...
2025-11-24 22:07:51,978 - secure_file_manager - INFO - Rotating integrity signature.
2025-11-24 22:07:51,980 - secure_file_manager - INFO - Using HMAC-SHA256 for integrity signature.
2025-11-24 22:07:51,982 - secure_file_manager - INFO - Integrity signature written to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_b1sl9hc9\integrity_file
2025-11-24 22:07:51,982 - __main__ - INFO - Integrity signature regenerated, retrying verification...
2025-11-24 22:07:51,983 - secure_file_manager - INFO - Verifying integrity...
2025-11-24 22:07:51,992 - secure_file_manager - INFO - Verifying with HMAC-SHA256.
2025-11-24 22:07:51,993 - secure_file_manager - INFO - Integrity verification result: OK
2025-11-24 22:07:51,993 - __main__ - INFO - Integrity recovery successful
2025-11-24 22:07:51,996 - __main__ - INFO - Test decryption and password verification successful
2025-11-24 22:07:51,996 - __main__ - INFO - Authentication successful!
2025-11-24 22:07:51,998 - __main__ - INFO - Schema migration check completed successfully.
2025-11-24 22:07:51,999 - __main__ - INFO - Encryption key set on secure_file_manager after login. Key is set: True
2025-11-24 22:07:51,999 - __main__ - INFO - Calling reload_settings() after successful auth...
2025-11-24 22:07:52,000 - secure_file_manager - INFO - Read 159 bytes from settings file
2025-11-24 22:07:52,000 - secure_file_manager - INFO - Decrypting encrypted settings file...
2025-11-24 22:07:52,001 - secure_file_manager - INFO - Successfully decrypted settings. Keys: ['activation_failed_attempts', 'activation_lockout_end_time']
2025-11-24 22:07:52,001 - auth_guardian - INFO - Reloading settings, read_settings returned: ['activation_failed_attempts', 'activation_lockout_end_time']
2025-11-24 22:07:52,002 - auth_guardian - INFO - tfa_secret present in reloaded settings: False
2025-11-24 22:07:52,002 - auth_guardian - INFO - tfa_enabled_at present in reloaded settings: False
2025-11-24 22:07:52,002 - auth_guardian - INFO - After reload, _settings has: ['activation_failed_attempts', 'activation_lockout_end_time']
2025-11-24 22:07:52,003 - auth_guardian - INFO - After reload, is_tfa_enabled(): False
2025-11-24 22:07:52,003 - __main__ - INFO - reload_settings() completed
2025-11-24 22:07:52,003 - __main__ - INFO - Recording login attempt after settings reload...
2025-11-24 22:07:52,004 - auth_guardian - INFO - Successful master password login recorded. Resetting guardian state.
2025-11-24 22:07:52,004 - secure_file_manager - INFO - Read 159 bytes from settings file
2025-11-24 22:07:52,005 - secure_file_manager - INFO - Decrypting encrypted settings file...
2025-11-24 22:07:52,006 - secure_file_manager - INFO - Successfully decrypted settings. Keys: ['activation_failed_attempts', 'activation_lockout_end_time']
2025-11-24 22:07:52,007 - auth_guardian - INFO - Loaded existing settings before save. Keys: ['activation_failed_attempts', 'activation_lockout_end_time']
2025-11-24 22:07:52,007 - auth_guardian - INFO - About to save settings. Keys to save: ['activation_failed_attempts', 'activation_lockout_end_time', 'guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time']
2025-11-24 22:07:52,008 - secure_file_manager - INFO - Writing encrypted settings to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_b1sl9hc9\settings.json. Settings keys: ['activation_failed_attempts', 'activation_lockout_end_time', 'guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time']
2025-11-24 22:07:52,010 - secure_file_manager - INFO - Rotating integrity signature.
2025-11-24 22:07:52,021 - secure_file_manager - INFO - Using HMAC-SHA256 for integrity signature.
2025-11-24 22:07:52,023 - secure_file_manager - INFO - Integrity signature written to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_b1sl9hc9\integrity_file
2025-11-24 22:07:52,023 - secure_file_manager - INFO - Settings file written successfully. Size: 479 bytes
2025-11-24 22:07:52,024 - auth_guardian - INFO - Successfully saved settings. Keys: ['activation_failed_attempts', 'activation_lockout_end_time', 'guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time']
2025-11-24 22:07:52,025 - secure_file_manager - INFO - Read 479 bytes from settings file
2025-11-24 22:07:52,025 - secure_file_manager - INFO - Decrypting encrypted settings file...
2025-11-24 22:07:52,025 - secure_file_manager - INFO - Successfully decrypted settings. Keys: ['activation_failed_attempts', 'activation_lockout_end_time', 'guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time']
2025-11-24 22:07:52,026 - auth_guardian - INFO - Loaded existing settings before save. Keys: ['activation_failed_attempts', 'activation_lockout_end_time', 'guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time']
2025-11-24 22:07:52,026 - auth_guardian - INFO - About to save settings. Keys to save: ['activation_failed_attempts', 'activation_lockout_end_time', 'guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time']
2025-11-24 22:07:52,027 - secure_file_manager - INFO - Writing encrypted settings to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_b1sl9hc9\settings.json. Settings keys: ['activation_failed_attempts', 'activation_lockout_end_time', 'guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time']
2025-11-24 22:07:52,029 - secure_file_manager - INFO - Rotating integrity signature.
2025-11-24 22:07:52,039 - secure_file_manager - INFO - Using HMAC-SHA256 for integrity signature.
2025-11-24 22:07:52,041 - secure_file_manager - INFO - Integrity signature written to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_b1sl9hc9\integrity_file
2025-11-24 22:07:52,042 - secure_file_manager - INFO - Settings file written successfully. Size: 479 bytes
2025-11-24 22:07:52,042 - auth_guardian - INFO - Successfully saved settings. Keys: ['activation_failed_attempts', 'activation_lockout_end_time', 'guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time']
2025-11-24 22:07:52,043 - __main__ - INFO - Login attempt recorded
2025-11-24 22:07:52,043 - __main__ - INFO - Loading settings from auth_guardian: ['activation_failed_attempts', 'activation_lockout_end_time']
2025-11-24 22:07:52,043 - __main__ - INFO - Loaded tutorial_completed: False
2025-11-24 22:07:52,043 - __main__ - INFO - load_settings() completed
2025-11-24 22:07:52,043 - __main__ - INFO - Checking 2FA status: hasattr(auth_guardian)=True, auth_guardian exists=True
2025-11-24 22:07:52,044 - __main__ - INFO - 2FA is_tfa_enabled() returned: False
2025-11-24 22:07:52,044 - __main__ - INFO - 2FA is not enabled, skipping 2FA verification
2025-11-24 22:07:52,044 - auth_guardian - INFO - Updating setting 'last_login_timestamp' and persisting changes.
2025-11-24 22:07:52,045 - secure_file_manager - INFO - Read 479 bytes from settings file
2025-11-24 22:07:52,045 - secure_file_manager - INFO - Decrypting encrypted settings file...
2025-11-24 22:07:52,045 - secure_file_manager - INFO - Successfully decrypted settings. Keys: ['activation_failed_attempts', 'activation_lockout_end_time', 'guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time']
2025-11-24 22:07:52,046 - auth_guardian - INFO - Loaded existing settings before save. Keys: ['activation_failed_attempts', 'activation_lockout_end_time', 'guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time']
2025-11-24 22:07:52,046 - auth_guardian - INFO - About to save settings. Keys to save: ['activation_failed_attempts', 'activation_lockout_end_time', 'guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time', 'last_login_timestamp']
2025-11-24 22:07:52,047 - secure_file_manager - INFO - Writing encrypted settings to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_b1sl9hc9\settings.json. Settings keys: ['activation_failed_attempts', 'activation_lockout_end_time', 'guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time', 'last_login_timestamp']
2025-11-24 22:07:52,049 - secure_file_manager - INFO - Rotating integrity signature.
2025-11-24 22:07:52,060 - secure_file_manager - INFO - Using HMAC-SHA256 for integrity signature.
2025-11-24 22:07:52,062 - secure_file_manager - INFO - Integrity signature written to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_b1sl9hc9\integrity_file
2025-11-24 22:07:52,062 - secure_file_manager - INFO - Settings file written successfully. Size: 539 bytes
2025-11-24 22:07:52,062 - auth_guardian - INFO - Successfully saved settings. Keys: ['activation_failed_attempts', 'activation_lockout_end_time', 'guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time', 'last_login_timestamp']
2025-11-24 22:07:52,063 - auth_guardian - INFO - Updating setting 'consecutive_logins' and persisting changes.
2025-11-24 22:07:52,063 - secure_file_manager - INFO - Read 539 bytes from settings file
2025-11-24 22:07:52,064 - secure_file_manager - INFO - Decrypting encrypted settings file...
2025-11-24 22:07:52,064 - secure_file_manager - INFO - Successfully decrypted settings. Keys: ['activation_failed_attempts', 'activation_lockout_end_time', 'guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time', 'last_login_timestamp']
2025-11-24 22:07:52,065 - auth_guardian - INFO - Loaded existing settings before save. Keys: ['activation_failed_attempts', 'activation_lockout_end_time', 'guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time', 'last_login_timestamp']
2025-11-24 22:07:52,065 - auth_guardian - INFO - About to save settings. Keys to save: ['activation_failed_attempts', 'activation_lockout_end_time', 'guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time', 'last_login_timestamp', 'consecutive_logins']
2025-11-24 22:07:52,065 - secure_file_manager - INFO - Writing encrypted settings to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_b1sl9hc9\settings.json. Settings keys: ['activation_failed_attempts', 'activation_lockout_end_time', 'guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time', 'last_login_timestamp', 'consecutive_logins']
2025-11-24 22:07:52,067 - secure_file_manager - INFO - Rotating integrity signature.
2025-11-24 22:07:52,078 - secure_file_manager - INFO - Using HMAC-SHA256 for integrity signature.
2025-11-24 22:07:52,079 - secure_file_manager - INFO - Integrity signature written to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_b1sl9hc9\integrity_file
2025-11-24 22:07:52,080 - secure_file_manager - INFO - Settings file written successfully. Size: 579 bytes
2025-11-24 22:07:52,080 - auth_guardian - INFO - Successfully saved settings. Keys: ['activation_failed_attempts', 'activation_lockout_end_time', 'guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time', 'last_login_timestamp', 'consecutive_logins']
2025-11-24 22:07:52,978 - __main__ - INFO - Starting deferred startup tasks...
2025-11-24 22:07:52,978 - password_reminder - INFO - PasswordReminder initialized
2025-11-24 22:07:52,978 - password_reminder - INFO - Starting PasswordReminder timer (first check in 30 seconds)
2025-11-24 22:07:52,979 - password_reminder - INFO - Starting PasswordReminder timer (first check in 30 seconds)
2025-11-24 22:07:52,980 - __main__ - INFO - Password reminder initialized and started
2025-11-24 22:07:52,980 - __main__ - INFO - Expired passwords count updated
2025-11-24 22:07:52,980 - __main__ - INFO - Deferred startup tasks completed
2025-11-24 22:08:07,983 - password_reminder - INFO - Found 0 accounts older than 5 minutes
2025-11-24 22:08:07,985 - password_reminder - INFO - Found 0 accounts older than 5 minutes
2025-11-24 22:08:16,044 - restore_helper - INFO - Attempting to restore backup from C:/Users/Hamza/Desktop/backup_20251123T161810Z.svbk into vault C:\Users\Hamza\AppData\Local\Temp\sv_tmp_b1sl9hc9
2025-11-24 22:08:16,045 - restore_helper - INFO - Created temporary directory for restore: C:\Users\Hamza\AppData\Local\Temp\sv_restore_y8esto_k
2025-11-24 22:08:16,046 - backup_manager - INFO - Restoring backup from C:/Users/Hamza/Desktop/backup_20251123T161810Z.svbk...
2025-11-24 22:08:16,057 - backup_manager - INFO - Detected backup version: V2 (IV length: 12 bytes)
2025-11-24 22:08:16,175 - backup_manager - INFO - Restoring files to C:\Users\Hamza\AppData\Local\Temp\sv_restore_y8esto_k
2025-11-24 22:08:16,183 - backup_manager - INFO - Restored 5 files successfully.
2025-11-24 22:08:16,183 - restore_helper - INFO - Successfully restored 5 files to temporary directory.
2025-11-24 22:08:16,184 - restore_helper - INFO - Skipping re-encryption of backup files.
2025-11-24 22:08:16,184 - restore_helper - INFO - The backup files are already properly encrypted with their original salt.
2025-11-24 22:08:16,184 - restore_helper - INFO - The restored salt file will be used for key derivation on next login.
2025-11-24 22:08:16,185 - restore_helper - INFO - Moving restored files into vault directory...
2025-11-24 22:08:16,185 - restore_helper - INFO - Backing up existing file C:\Users\Hamza\AppData\Local\Temp\sv_tmp_b1sl9hc9\metadata.db to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_b1sl9hc9\metadata.db.bak.20251124T210816Z
2025-11-24 22:08:16,186 - restore_helper - INFO - Moving C:\Users\Hamza\AppData\Local\Temp\sv_restore_y8esto_k\metadata.db to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_b1sl9hc9\metadata.db
2025-11-24 22:08:16,187 - restore_helper - INFO - Backing up existing file C:\Users\Hamza\AppData\Local\Temp\sv_tmp_b1sl9hc9\sensitive.db to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_b1sl9hc9\sensitive.db.bak.20251124T210816Z
2025-11-24 22:08:16,188 - restore_helper - INFO - Moving C:\Users\Hamza\AppData\Local\Temp\sv_restore_y8esto_k\sensitive.db to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_b1sl9hc9\sensitive.db
2025-11-24 22:08:16,190 - restore_helper - INFO - Backing up existing file C:\Users\Hamza\AppData\Local\Temp\sv_tmp_b1sl9hc9\salt_file to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_b1sl9hc9\salt_file.bak.20251124T210816Z
2025-11-24 22:08:16,192 - restore_helper - INFO - Moving C:\Users\Hamza\AppData\Local\Temp\sv_restore_y8esto_k\salt_file to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_b1sl9hc9\salt_file
2025-11-24 22:08:16,193 - restore_helper - INFO - Backing up existing file C:\Users\Hamza\AppData\Local\Temp\sv_tmp_b1sl9hc9\integrity_file to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_b1sl9hc9\integrity_file.bak.20251124T210816Z
2025-11-24 22:08:16,194 - restore_helper - INFO - Moving C:\Users\Hamza\AppData\Local\Temp\sv_restore_y8esto_k\integrity_file to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_b1sl9hc9\integrity_file
2025-11-24 22:08:16,250 - restore_helper - INFO - Cleaning up temporary directory: C:\Users\Hamza\AppData\Local\Temp\sv_restore_y8esto_k
2025-11-24 22:08:16,251 - restore_helper - INFO - Restore complete. Moved 4 files, created 4 backups.
2025-11-24 22:08:16,251 - restore_helper - INFO - IMPORTANT: The application must be restarted for the restored data to be loaded.
2025-11-24 22:08:16,252 - restore_helper - INFO - On next login, use the same master password with the restored salt file.
2025-11-24 22:08:19,827 - __main__ - INFO - Syncing files to secure storage before closing...
2025-11-24 22:08:19,934 - secure_file_manager - INFO - Syncing all files...
2025-11-24 22:08:19,935 - secure_file_manager - INFO - Syncing from temp directory: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_b1sl9hc9
2025-11-24 22:08:19,942 - secure_file_manager - INFO - Rotating integrity signature.
2025-11-24 22:08:19,944 - secure_file_manager - INFO - Using HMAC-SHA256 for integrity signature.
2025-11-24 22:08:19,946 - secure_file_manager - INFO - Integrity signature written to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_b1sl9hc9\integrity_file
2025-11-24 22:08:19,946 - secure_file_manager - INFO - Sync from temp directory completed.
2025-11-24 22:08:19,947 - __main__ - INFO - Files synced successfully
2025-11-24 22:08:19,988 - __main__ - INFO - Performing final sync and cleanup...
2025-11-24 22:08:20,128 - secure_file_manager - INFO - Syncing all files...
2025-11-24 22:08:20,128 - secure_file_manager - INFO - Syncing from temp directory: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_b1sl9hc9
2025-11-24 22:08:20,135 - secure_file_manager - INFO - Rotating integrity signature.
2025-11-24 22:08:20,137 - secure_file_manager - INFO - Using HMAC-SHA256 for integrity signature.
2025-11-24 22:08:20,139 - secure_file_manager - INFO - Integrity signature written to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_b1sl9hc9\integrity_file
2025-11-24 22:08:20,140 - secure_file_manager - INFO - Sync from temp directory completed.
2025-11-24 22:08:20,141 - secure_file_manager - INFO - Cleaning up temporary files...
2025-11-24 22:08:20,141 - secure_file_manager - INFO - Removing temp directory: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_b1sl9hc9
2025-11-24 22:08:20,145 - secure_file_manager - INFO - Restored paths to secure directory. settings_path now: secure_vault\settings.json
2025-11-24 22:08:20,145 - secure_file_manager - INFO - Temporary files cleaned up successfully.
2025-11-24 22:08:20,146 - __main__ - INFO - Secure cleanup completed
2025-11-24 22:08:24,644 - root - INFO - Logging has been set up.
2025-11-24 22:08:24,644 - __main__ - INFO - Starting SecureVault Pro...
2025-11-24 22:08:24,768 - asyncio_manager - INFO - Asyncio event loop started in background thread.
2025-11-24 22:08:25,465 - __main__ - INFO - Application initialized successfully
2025-11-24 22:08:29,379 - __main__ - INFO - Initializing secure file management system...
2025-11-24 22:08:29,385 - __main__ - INFO - Secure file manager initialized
2025-11-24 22:08:29,947 - secure_file_manager - INFO - Read 579 bytes from settings file
2025-11-24 22:08:29,947 - secure_file_manager - WARNING - Settings file is encrypted, but no encryption key is available (this is expected on startup).
2025-11-24 22:08:30,498 - root - INFO - --- Starting Trial Status Check ---
2025-11-24 22:08:30,499 - root - INFO - License file found at C:\Users\Hamza/sv-license-92123735fb6d0072.lic. Status: FULL
2025-11-24 22:08:30,499 - __main__ - INFO - Trial status at startup: FULL
2025-11-24 22:08:30,965 - auth_guardian - INFO - AuthGuardian init: No encryption key available, starting with empty settings. Will reload after authentication.
2025-11-24 22:08:30,965 - __main__ - INFO - Loading settings from auth_guardian: []
2025-11-24 22:08:30,966 - __main__ - INFO - Loaded tutorial_completed: False
2025-11-24 22:08:30,970 - secure_file_manager - INFO - Initializing encryption...
2025-11-24 22:08:30,980 - secure_file_manager - INFO - Salt loaded from secure_vault\salt_file
2025-11-24 22:08:30,982 - secure_file_manager - INFO - Using 'cryptography' package for key derivation.
2025-11-24 22:08:31,106 - secure_file_manager - INFO - Encryption key derived successfully.
2025-11-24 22:08:31,107 - secure_file_manager - INFO - Loading files to temporary directory...
2025-11-24 22:08:31,109 - secure_file_manager - INFO - Created new temp directory: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_93d2zig1
2025-11-24 22:08:31,118 - secure_file_manager - INFO - Updated paths to point to temp directory. settings_path now: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_93d2zig1\settings.json
2025-11-24 22:08:31,118 - secure_file_manager - INFO - Files loaded to temp directory successfully.
2025-11-24 22:08:31,119 - __main__ - INFO - Attempting authentication...
2025-11-24 22:08:31,119 - __main__ - INFO - Salt path: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_93d2zig1\salt_file
2025-11-24 22:08:31,119 - __main__ - INFO - Metadata DB path: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_93d2zig1\metadata.db
2025-11-24 22:08:31,119 - __main__ - INFO - Sensitive DB path: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_93d2zig1\sensitive.db
2025-11-24 22:08:31,120 - __main__ - INFO - Integrity path: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_93d2zig1\integrity_file
2025-11-24 22:08:31,121 - __main__ - INFO - Salt loaded successfully (32 bytes)
2025-11-24 22:08:31,246 - __main__ - INFO - Encryption keys generated
2025-11-24 22:08:31,246 - secure_file_manager - INFO - Verifying integrity...
2025-11-24 22:08:31,263 - secure_file_manager - INFO - Verifying with HMAC-SHA256.
2025-11-24 22:08:31,264 - secure_file_manager - INFO - Integrity verification result: FAILED
2025-11-24 22:08:31,264 - __main__ - INFO - Database integrity check: FAILED
2025-11-24 22:08:31,264 - __main__ - ERROR - Database integrity check failed
2025-11-24 22:08:31,265 - __main__ - INFO - Attempting integrity recovery...
2025-11-24 22:08:31,265 - secure_file_manager - INFO - Rotating integrity signature.
2025-11-24 22:08:31,267 - secure_file_manager - INFO - Using HMAC-SHA256 for integrity signature.
2025-11-24 22:08:31,269 - secure_file_manager - INFO - Integrity signature written to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_93d2zig1\integrity_file
2025-11-24 22:08:31,269 - __main__ - INFO - Integrity signature regenerated, retrying verification...
2025-11-24 22:08:31,270 - secure_file_manager - INFO - Verifying integrity...
2025-11-24 22:08:31,283 - secure_file_manager - INFO - Verifying with HMAC-SHA256.
2025-11-24 22:08:31,283 - secure_file_manager - INFO - Integrity verification result: OK
2025-11-24 22:08:31,284 - __main__ - INFO - Integrity recovery successful
2025-11-24 22:08:31,287 - __main__ - ERROR - Test decryption failed: Invalid authentication tag. This almost certainly means the password is wrong.
2025-11-24 22:08:34,123 - __main__ - INFO - Initializing encryption...
2025-11-24 22:08:34,124 - secure_file_manager - INFO - Initializing encryption...
2025-11-24 22:08:34,125 - secure_file_manager - INFO - Salt loaded from C:\Users\Hamza\AppData\Local\Temp\sv_tmp_93d2zig1\salt_file
2025-11-24 22:08:34,125 - secure_file_manager - INFO - Using 'cryptography' package for key derivation.
2025-11-24 22:08:34,243 - secure_file_manager - INFO - Encryption key derived successfully.
2025-11-24 22:08:34,244 - __main__ - INFO - Loading files from secure storage...
2025-11-24 22:08:34,244 - secure_file_manager - INFO - Loading files to temporary directory...
2025-11-24 22:08:34,245 - secure_file_manager - INFO - Removing old temp directory: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_93d2zig1
2025-11-24 22:08:34,247 - secure_file_manager - INFO - Created new temp directory: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ty4f5l7q
2025-11-24 22:08:34,255 - secure_file_manager - INFO - Updated paths to point to temp directory. settings_path now: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ty4f5l7q\settings.json
2025-11-24 22:08:34,257 - secure_file_manager - INFO - Files loaded to temp directory successfully.
2025-11-24 22:08:34,258 - __main__ - INFO - Attempting authentication...
2025-11-24 22:08:34,258 - __main__ - INFO - Salt path: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ty4f5l7q\salt_file
2025-11-24 22:08:34,258 - __main__ - INFO - Metadata DB path: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ty4f5l7q\metadata.db
2025-11-24 22:08:34,258 - __main__ - INFO - Sensitive DB path: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ty4f5l7q\sensitive.db
2025-11-24 22:08:34,259 - __main__ - INFO - Integrity path: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ty4f5l7q\integrity_file
2025-11-24 22:08:34,261 - __main__ - INFO - Salt loaded successfully (32 bytes)
2025-11-24 22:08:34,381 - __main__ - INFO - Encryption keys generated
2025-11-24 22:08:34,381 - secure_file_manager - INFO - Verifying integrity...
2025-11-24 22:08:34,386 - secure_file_manager - INFO - Verifying with HMAC-SHA256.
2025-11-24 22:08:34,387 - secure_file_manager - INFO - Integrity verification result: FAILED
2025-11-24 22:08:34,387 - __main__ - INFO - Database integrity check: FAILED
2025-11-24 22:08:34,388 - __main__ - ERROR - Database integrity check failed
2025-11-24 22:08:34,388 - __main__ - INFO - Attempting integrity recovery...
2025-11-24 22:08:34,388 - secure_file_manager - INFO - Rotating integrity signature.
2025-11-24 22:08:34,390 - secure_file_manager - INFO - Using HMAC-SHA256 for integrity signature.
2025-11-24 22:08:34,392 - secure_file_manager - INFO - Integrity signature written to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ty4f5l7q\integrity_file
2025-11-24 22:08:34,392 - __main__ - INFO - Integrity signature regenerated, retrying verification...
2025-11-24 22:08:34,392 - secure_file_manager - INFO - Verifying integrity...
2025-11-24 22:08:34,403 - secure_file_manager - INFO - Verifying with HMAC-SHA256.
2025-11-24 22:08:34,403 - secure_file_manager - INFO - Integrity verification result: OK
2025-11-24 22:08:34,403 - __main__ - INFO - Integrity recovery successful
2025-11-24 22:08:34,406 - __main__ - INFO - Test decryption and password verification successful
2025-11-24 22:08:34,407 - __main__ - INFO - Authentication successful!
2025-11-24 22:08:34,410 - __main__ - INFO - Schema migration check completed successfully.
2025-11-24 22:08:34,411 - __main__ - INFO - Encryption key set on secure_file_manager after login. Key is set: True
2025-11-24 22:08:34,411 - __main__ - INFO - Calling reload_settings() after successful auth...
2025-11-24 22:08:34,412 - secure_file_manager - INFO - Read 579 bytes from settings file
2025-11-24 22:08:34,412 - secure_file_manager - INFO - Decrypting encrypted settings file...
2025-11-24 22:08:34,413 - secure_file_manager - ERROR - Failed to decrypt settings file - InvalidTag or EncryptionWarning: 
2025-11-24 22:08:34,413 - auth_guardian - INFO - Reloading settings, read_settings returned: []
2025-11-24 22:08:34,413 - auth_guardian - INFO - tfa_secret present in reloaded settings: False
2025-11-24 22:08:34,413 - auth_guardian - INFO - tfa_enabled_at present in reloaded settings: False
2025-11-24 22:08:34,414 - auth_guardian - INFO - After reload, _settings has: []
2025-11-24 22:08:34,414 - auth_guardian - INFO - After reload, is_tfa_enabled(): False
2025-11-24 22:08:34,414 - __main__ - INFO - reload_settings() completed
2025-11-24 22:08:34,414 - __main__ - INFO - Recording login attempt after settings reload...
2025-11-24 22:08:34,415 - auth_guardian - INFO - Successful master password login recorded. Resetting guardian state.
2025-11-24 22:08:34,415 - secure_file_manager - INFO - Read 579 bytes from settings file
2025-11-24 22:08:34,416 - secure_file_manager - INFO - Decrypting encrypted settings file...
2025-11-24 22:08:34,416 - secure_file_manager - ERROR - Failed to decrypt settings file - InvalidTag or EncryptionWarning: 
2025-11-24 22:08:34,417 - auth_guardian - INFO - No existing settings file found, starting with empty dict
2025-11-24 22:08:34,417 - auth_guardian - INFO - About to save settings. Keys to save: ['guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time']
2025-11-24 22:08:34,418 - secure_file_manager - INFO - Writing encrypted settings to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ty4f5l7q\settings.json. Settings keys: ['guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time']
2025-11-24 22:08:34,420 - secure_file_manager - INFO - Rotating integrity signature.
2025-11-24 22:08:34,431 - secure_file_manager - INFO - Using HMAC-SHA256 for integrity signature.
2025-11-24 22:08:34,433 - secure_file_manager - INFO - Integrity signature written to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ty4f5l7q\integrity_file
2025-11-24 22:08:34,434 - secure_file_manager - INFO - Settings file written successfully. Size: 375 bytes
2025-11-24 22:08:34,434 - auth_guardian - INFO - Successfully saved settings. Keys: ['guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time']
2025-11-24 22:08:34,435 - secure_file_manager - INFO - Read 375 bytes from settings file
2025-11-24 22:08:34,435 - secure_file_manager - INFO - Decrypting encrypted settings file...
2025-11-24 22:08:34,436 - secure_file_manager - INFO - Successfully decrypted settings. Keys: ['guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time']
2025-11-24 22:08:34,436 - auth_guardian - INFO - Loaded existing settings before save. Keys: ['guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time']
2025-11-24 22:08:34,437 - auth_guardian - INFO - About to save settings. Keys to save: ['guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time']
2025-11-24 22:08:34,437 - secure_file_manager - INFO - Writing encrypted settings to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ty4f5l7q\settings.json. Settings keys: ['guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time']
2025-11-24 22:08:34,439 - secure_file_manager - INFO - Rotating integrity signature.
2025-11-24 22:08:34,451 - secure_file_manager - INFO - Using HMAC-SHA256 for integrity signature.
2025-11-24 22:08:34,452 - secure_file_manager - INFO - Integrity signature written to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ty4f5l7q\integrity_file
2025-11-24 22:08:34,453 - secure_file_manager - INFO - Settings file written successfully. Size: 375 bytes
2025-11-24 22:08:34,453 - auth_guardian - INFO - Successfully saved settings. Keys: ['guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time']
2025-11-24 22:08:34,454 - __main__ - INFO - Login attempt recorded
2025-11-24 22:08:34,454 - __main__ - INFO - Loading settings from auth_guardian: []
2025-11-24 22:08:34,454 - __main__ - INFO - Loaded tutorial_completed: False
2025-11-24 22:08:34,454 - __main__ - INFO - load_settings() completed
2025-11-24 22:08:34,454 - __main__ - INFO - Checking 2FA status: hasattr(auth_guardian)=True, auth_guardian exists=True
2025-11-24 22:08:34,455 - __main__ - INFO - 2FA is_tfa_enabled() returned: False
2025-11-24 22:08:34,456 - __main__ - INFO - 2FA is not enabled, skipping 2FA verification
2025-11-24 22:08:34,457 - auth_guardian - INFO - Updating setting 'last_login_timestamp' and persisting changes.
2025-11-24 22:08:34,458 - secure_file_manager - INFO - Read 375 bytes from settings file
2025-11-24 22:08:34,458 - secure_file_manager - INFO - Decrypting encrypted settings file...
2025-11-24 22:08:34,458 - secure_file_manager - INFO - Successfully decrypted settings. Keys: ['guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time']
2025-11-24 22:08:34,459 - auth_guardian - INFO - Loaded existing settings before save. Keys: ['guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time']
2025-11-24 22:08:34,460 - auth_guardian - INFO - About to save settings. Keys to save: ['guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time', 'last_login_timestamp']
2025-11-24 22:08:34,460 - secure_file_manager - INFO - Writing encrypted settings to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ty4f5l7q\settings.json. Settings keys: ['guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time', 'last_login_timestamp']
2025-11-24 22:08:34,462 - secure_file_manager - INFO - Rotating integrity signature.
2025-11-24 22:08:34,474 - secure_file_manager - INFO - Using HMAC-SHA256 for integrity signature.
2025-11-24 22:08:34,475 - secure_file_manager - INFO - Integrity signature written to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ty4f5l7q\integrity_file
2025-11-24 22:08:34,476 - secure_file_manager - INFO - Settings file written successfully. Size: 435 bytes
2025-11-24 22:08:34,476 - auth_guardian - INFO - Successfully saved settings. Keys: ['guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time', 'last_login_timestamp']
2025-11-24 22:08:34,477 - auth_guardian - INFO - Updating setting 'consecutive_logins' and persisting changes.
2025-11-24 22:08:34,478 - secure_file_manager - INFO - Read 435 bytes from settings file
2025-11-24 22:08:34,478 - secure_file_manager - INFO - Decrypting encrypted settings file...
2025-11-24 22:08:34,478 - secure_file_manager - INFO - Successfully decrypted settings. Keys: ['guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time', 'last_login_timestamp']
2025-11-24 22:08:34,479 - auth_guardian - INFO - Loaded existing settings before save. Keys: ['guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time', 'last_login_timestamp']
2025-11-24 22:08:34,480 - auth_guardian - INFO - About to save settings. Keys to save: ['guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time', 'last_login_timestamp', 'consecutive_logins']
2025-11-24 22:08:34,480 - secure_file_manager - INFO - Writing encrypted settings to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ty4f5l7q\settings.json. Settings keys: ['guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time', 'last_login_timestamp', 'consecutive_logins']
2025-11-24 22:08:34,483 - secure_file_manager - INFO - Rotating integrity signature.
2025-11-24 22:08:34,494 - secure_file_manager - INFO - Using HMAC-SHA256 for integrity signature.
2025-11-24 22:08:34,495 - secure_file_manager - INFO - Integrity signature written to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ty4f5l7q\integrity_file
2025-11-24 22:08:34,496 - secure_file_manager - INFO - Settings file written successfully. Size: 475 bytes
2025-11-24 22:08:34,497 - auth_guardian - INFO - Successfully saved settings. Keys: ['guardian_failed_attempts', 'guardian_consecutive_lockouts', 'guardian_lockout_end_time', 'guardian_tfa_failed_attempts', 'guardian_consecutive_tfa_lockouts', 'guardian_tfa_lockout_end_time', 'last_login_timestamp', 'consecutive_logins']
2025-11-24 22:08:35,401 - __main__ - INFO - Starting deferred startup tasks...
2025-11-24 22:08:35,402 - password_reminder - INFO - PasswordReminder initialized
2025-11-24 22:08:35,402 - password_reminder - INFO - Starting PasswordReminder timer (first check in 30 seconds)
2025-11-24 22:08:35,403 - password_reminder - INFO - Starting PasswordReminder timer (first check in 30 seconds)
2025-11-24 22:08:35,403 - __main__ - INFO - Password reminder initialized and started
2025-11-24 22:08:35,404 - __main__ - INFO - Expired passwords count updated
2025-11-24 22:08:35,404 - __main__ - INFO - Deferred startup tasks completed
2025-11-24 22:08:50,413 - password_reminder - INFO - Found 2 accounts older than 5 minutes
2025-11-24 22:08:50,413 - password_reminder - INFO - Adding reminder for account: jhjhhjjh (ID: 0GNNkTyq8COX2EW-XNbb9g, Last updated: 2025-11-23T17:16:53.325042)
2025-11-24 22:08:50,426 - password_reminder - INFO - Adding reminder for account: 546465456 (ID: x3fOXCy1qmRUlXVOyIH9lA, Last updated: 2025-11-23T17:17:47.515800)
2025-11-24 22:08:50,427 - password_reminder - INFO - Found 2 accounts older than 5 minutes
2025-11-24 22:09:04,510 - notification_manager - ERROR - Unexpected error in notification system: Notification.__init__() got an unexpected keyword argument 'app_name'
2025-11-24 22:09:04,511 - notification_manager - WARNING - Notification system test failed - notifications may not work
2025-11-24 22:09:50,446 - password_reminder - INFO - Found 2 accounts older than 5 minutes
2025-11-24 22:09:50,460 - password_reminder - INFO - Found 2 accounts older than 5 minutes
2025-11-24 22:10:22,330 - __main__ - INFO - Syncing files to secure storage before closing...
2025-11-24 22:10:22,435 - secure_file_manager - INFO - Syncing all files...
2025-11-24 22:10:22,435 - secure_file_manager - INFO - Syncing from temp directory: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ty4f5l7q
2025-11-24 22:10:22,443 - secure_file_manager - INFO - Rotating integrity signature.
2025-11-24 22:10:22,444 - secure_file_manager - INFO - Using HMAC-SHA256 for integrity signature.
2025-11-24 22:10:22,446 - secure_file_manager - INFO - Integrity signature written to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ty4f5l7q\integrity_file
2025-11-24 22:10:22,447 - secure_file_manager - INFO - Sync from temp directory completed.
2025-11-24 22:10:22,447 - __main__ - INFO - Files synced successfully
2025-11-24 22:10:22,543 - __main__ - INFO - Performing final sync and cleanup...
2025-11-24 22:10:22,655 - secure_file_manager - INFO - Syncing all files...
2025-11-24 22:10:22,656 - secure_file_manager - INFO - Syncing from temp directory: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ty4f5l7q
2025-11-24 22:10:22,663 - secure_file_manager - INFO - Rotating integrity signature.
2025-11-24 22:10:22,665 - secure_file_manager - INFO - Using HMAC-SHA256 for integrity signature.
2025-11-24 22:10:22,667 - secure_file_manager - INFO - Integrity signature written to C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ty4f5l7q\integrity_file
2025-11-24 22:10:22,667 - secure_file_manager - INFO - Sync from temp directory completed.
2025-11-24 22:10:22,668 - secure_file_manager - INFO - Cleaning up temporary files...
2025-11-24 22:10:22,668 - secure_file_manager - INFO - Removing temp directory: C:\Users\Hamza\AppData\Local\Temp\sv_tmp_ty4f5l7q
2025-11-24 22:10:22,672 - secure_file_manager - INFO - Restored paths to secure directory. settings_path now: secure_vault\settings.json
2025-11-24 22:10:22,672 - secure_file_manager - INFO - Temporary files cleaned up successfully.
2025-11-24 22:10:22,672 - __main__ - INFO - Secure cleanup completed
